{"componentChunkName":"component---src-templates-blog-post-js","path":"/woowa-todolist/","result":{"data":{"site":{"siteMetadata":{"title":"young's Blog"}},"markdownRemark":{"id":"5ea20633-ed7a-5130-9033-676c8d9b4b4a","excerpt":"우아한 우아한 테크캠프 2번째 과제를 하며 겪었던 경험과 위기 그리고 배운 점과 아쉬운 점을 정리해보고자 합니다. Ground Rule…","html":"<h3>우아한</h3>\n<p>우아한 테크캠프 2번째 과제를 하며 겪었던 경험과 위기 그리고 배운 점과 아쉬운 점을 정리해보고자 합니다.</p>\n<h2>Ground Rule</h2>\n<p>새로운 팀원인 현욱님과 정한 저희 팀의 그라운드 룰입니다. 설계 후 첫번째 사이클까지 페어 프로그래밍으로 진행하고 다음 부분부터 분업으로 하기로 한 내용이 눈에 띕니다. 일관성있는 코드를 작성하기 위해서 다음과 같은 방향을 제시했는데 현욱님이 흔쾌히 응해주셔서 너무 감사했습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b1e79c6a365a1f53a4acec4cd2e59d39/6c2de/groundrule.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.1081081081081%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAABeUlEQVQ4y6WUC2+CMBSF+f+/b8YNeYnyLG9QKAXOeu/iojNzykhuUkpzek77XYy3zRaO4+LnsywL1jxGKgSiKEbTtkhTgbwoMM8zCz5b1waMsqxga4fHIEDdNGia9mVX12mMrusQBCHCKGKnQmS6hN4g5PkkTRGGEY9FliGOEwT0ritJUk5z4zDPcxRlCXLa9z2UUhhHBSlHyHHU46+id/rG81J+z99Fdl0Plu1g7x94wWXH1ZGHYYCjRSkuxaQYl0WrLoUif5g7Rsf1vP9jMwySb7dtO9R1/bKjO0FzZ2Fn2czgmjO7E2w1NoRGluUMNbksuhlJMyHVFdcTokpBNAphOaI+T48dllXFDNL5+YcDc2Z6MTZ2BNPP8O7GsI56M9qkVjjL+bEgMUjYUKd4e58BHvoTlkkzNitMSgLz9Hzkvh8YFSpi8qzh/u3cnroU19tz5EcCf4ncCFKHeFqUfgrd6cSXQh2zlkWD+rLSItTLVPQ7o+5ZK/gJYEQwu3ypXSwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chinese Salty Egg\"\n        title=\"Chinese Salty Egg\"\n        src=\"/static/b1e79c6a365a1f53a4acec4cd2e59d39/fcda8/groundrule.png\"\n        srcset=\"/static/b1e79c6a365a1f53a4acec4cd2e59d39/12f09/groundrule.png 148w,\n/static/b1e79c6a365a1f53a4acec4cd2e59d39/e4a3f/groundrule.png 295w,\n/static/b1e79c6a365a1f53a4acec4cd2e59d39/fcda8/groundrule.png 590w,\n/static/b1e79c6a365a1f53a4acec4cd2e59d39/efc66/groundrule.png 885w,\n/static/b1e79c6a365a1f53a4acec4cd2e59d39/c83ae/groundrule.png 1180w,\n/static/b1e79c6a365a1f53a4acec4cd2e59d39/6c2de/groundrule.png 1334w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>이와 같은 룰을 토대로 저희는 차근차근 작업을 진행했는데요. 생각보다 위기는 빨리 찾아왔습니다.</p>\n<h3>위기 #1 - 주변 팀들과의 비교</h3>\n<p>차근차근 같이 설정하고, DB설계를 하던 어느날, 다른 조들의 진행속도가 눈에 들어오기 시작했습니다. 드래그 앤 드랍이 완성되었다는 소식이 점점 들려오기 시작했을 때부터, 제 맘은 조급해지기 시작했습니다. 우린 아직 설계도 마무리하지 못했는데 말이죠. 다행스럽게도 현욱님이 제 마음을 잡아주셔서 끝까지 구조 잡고 프로젝트를 시작할 수 있었습니다. 그래도 조급해하던 저를 위해 일요일에 나와주셔서 너무 감사했어요 ㅎㅎ</p>\n<h3>위기 #2 - 설계의 문제점</h3>\n<p>드래그앤드랍을 하면서 이야기를 나눴던 부분은 다음과 같습니다.</p>\n<ol>\n<li>각 컴포넌트가 데이터를 가지고 있지 말고, Redux처럼 하나의 전역변수를 통해 관리하자</li>\n<li>각각 카드에서 발생된 이벤트는 카드 컴포넌트에서 처리하자</li>\n<li>변경이 필요할 시 전역변수를 통해 새로 그려주자</li>\n</ol>\n<p>그 결과로 작성된 Drag And Drop의 코드 중 일부를 보여드리겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// dragAndDrop.js</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token function\">onEnterOtherCard</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e<span class=\"token punctuation\">,</span> card</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setEnteredCard</span><span class=\"token punctuation\">(</span>card<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setDummyCardDirection</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> card<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">pushCardInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>enteredColumn<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">addClassToDummyCard</span><span class=\"token punctuation\">(</span>card<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// card.js</span>\n<span class=\"token function\">setEventListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setMouseDownEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setMouseEnterEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setMouseLeaveEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setMouseMoveEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeMouseEnterEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeMouseDownEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeMouseLeaveEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeMouseMoveEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> child <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span>lastElementChild<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    child <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span>lastElementChild<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol>\n<li>노트가 드래그가 시작되면 DraggedNote라는 변수에 저장합니다.</li>\n<li>드래그 된 노트가 다른 노트 영역으로 들어갔을 때, EnteredCard라는 변수에 저장합니다.</li>\n<li>Note Data를 모두 담고 있는 전역변수 columnData를 수정합니다.</li>\n<li>마우스 Position을 따라 dummy card가 삽입될 방향을 계산합니다.</li>\n<li>수정된 카드가 포함된 칼럼내의 모든 카드 Element의 이벤트 리스터를 지운 뒤 삭제합니다.</li>\n<li>columnData를 토대로 다시 Card Element를 만든 뒤 칼럼영역에 추가합니다.</li>\n<li>카드에 이벤트 리스너를 추가합니다.</li>\n</ol>\n<p>위와 같은 코드의 문제점은 금방 나타났습니다. 첫 번째로 수정에 대한 비용이 너무 비쌌고 자주 일어났습니다. 노트가 드래그되어 다른 노트영역으로 들어갈 때마다 이벤트가 발생되었거든요..</p>\n<p>두 번째로 이벤트가 일어났을 때의 과정이 너무 복잡하고 어려웠습니다. 칼럼에 대한 이벤트를 추가하자마자 생각지 못한 버그들로 인해 진행이 어려웠습니다. (mouse down → column enter → card enter → card leave …)</p>\n<h3>다시 시작하자</h3>\n<p>현욱님과 대책회의를 한 결과 기존 코드를 살리기 어려울 것 같다는 결론에 도달했습니다. 그래서…</p>\n<p>2박3일 동안 붙잡고 있던 코드들을 다 날리고 새로 짜기 시작했습니다. 새로운 Rule은 다음과 같습니다.</p>\n<ol>\n<li>컴포넌트는 그리는 것에만 집중!</li>\n<li>이벤트는 Drag and Drop 내에서만 처리. 이벤트 위임을 사용해서 최상단 컴포넌트에만 이벤트 리스너 적용</li>\n<li>업데이트는 최소화하여 변경이 필요할 경우에 한번만!</li>\n</ol>\n<p>그 결과 나온 코드는 아래와 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">static</span> <span class=\"token function\">onMouseUp</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateCardOrder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateCardElementId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">insertDraggedCard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">clearDraggedCard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">clearDummyCard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ol>\n<li>전역변수에서 카드 순서를 업데이트 합니다.</li>\n<li>드래그 중인 카드의 ID를 업데이트 합니다.</li>\n<li>변경된 위치에 삽입합니다.</li>\n<li>draggedCard 변수를 초기화 합니다.</li>\n<li>삽입될 위치를 보여줬던 dummyCard를 삭제합니다.</li>\n</ol>\n<p>다행스럽게도 조금 더 이해하기 쉽고, 예상한대로 동작하는 코드가 완성되었습니다. 기존 코드를 살리기 위해 노력하는 것보다 처음부터 다시 짜는 게 더 효과적일수 있다는 것을 배울 수 있었습니다.</p>\n<h3>급 마무리</h3>\n<p>드래그 앤 드랍이 완성 된 후 저희에게 남은 시간은 하루 반이 전부였습니다. 마지막 밤을 세고 시연 30분 전까지 코딩에 매달려있었지만.. 전체 기능은 다 구현하지 못한 채 마무리가 됬습니다.</p>","frontmatter":{"title":"두번째 프로젝트 - Todo List 개발기","date":"July 26, 2020","description":"This is a custom description for SEO and Open Graph purposes, rather than the default generated excerpt. Simply add a description field to the frontmatter."}}},"pageContext":{"slug":"/woowa-todolist/","previous":{"fields":{"slug":"/new-beginnings/"},"frontmatter":{"title":"New Beginnings"}},"next":null}}}